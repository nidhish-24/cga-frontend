<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard - Messages</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-5">
    <h2 class="text-center mb-4 fw-bold">Contact Form Submissions</h2>

    <table class="table table-bordered table-hover bg-white shadow">
        <thead class="table-dark">
            <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Message</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="messagesTable"></tbody>
    </table>
</div>

<script>
async function loadMessages() {
    const res = await fetch(" https://cga-backend-9iaz.onrender.com/api/messages");
    const data = await res.json();

    const table = document.getElementById("messagesTable");
    table.innerHTML = "";

    data.forEach(msg => {
        table.innerHTML += `
            <tr>
                <td>${msg.name}</td>
                <td>${msg.email}</td>
                <td>${msg.phone}</td>
                <td>${msg.message}</td>
                <td>
                    <button class="btn btn-danger btn-sm" onclick="deleteMessage('${msg._id}')">Delete</button>
                </td>
            </tr>
        `;
    });
}

async function deleteMessage(id) {
    const confirmed = confirm("Are you sure you want to delete this message?");
    if (!confirmed) return;

    await fetch(` https://cga-backend-9iaz.onrender.com/api/delete/${id}`, { method: "DELETE" });
    
    alert("Message deleted âœ…");
    loadMessages();
}

loadMessages();
</script>

</body>
</html>
